<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Microsoft on Gary Flynn</title>
    <link>https://garyflynn.com/tags/microsoft/</link>
    <description>Recent content in Microsoft on Gary Flynn</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <lastBuildDate>Fri, 22 Feb 2019 12:38:51 +0000</lastBuildDate><atom:link href="https://garyflynn.com/tags/microsoft/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>File Shares / SMB Not Working</title>
      <link>https://garyflynn.com/post/file-shares-smb-not-working/</link>
      <pubDate>Fri, 22 Feb 2019 12:38:51 +0000</pubDate>
      
      <guid>https://garyflynn.com/post/file-shares-smb-not-working/</guid>
      <description>
        
          
            &lt;p&gt;A strange issue occasionally occurs on some servers where random network dropouts occur while accessing any file share (ie. \\servername\c$). I recently came across this issue again and found this fantastic post on the &lt;a href=&#34;https://social.technet.microsoft.com/Forums/en-US/e9567167-22db-4b8c-9f96-a08b97d507f9/server-2012-r2-file-server-stops-responding-to-smb-connections?forum=winserverfiles&#34;&gt;technet forums&lt;/a&gt;. About half way down the page a solution is posted which fixed my issue!&lt;/p&gt;
&lt;p&gt;The short version is that in Windows Server 2012 R2 the service / driver SRV2(Server SMB 2.xxx Driver) startup method was changed from Auto to Manual / On Demand. This means that the service is not running unless SMB2 traffic is requested. To check the service status run the below command in PowerShell as Administrator.&lt;/p&gt;
          
          
        
      </description>
    </item>
    
    <item>
      <title>Create Active Directory Forest via PowerShell</title>
      <link>https://garyflynn.com/post/create-active-directory-forest-via-powershell/</link>
      <pubDate>Wed, 29 Aug 2018 13:17:09 +0000</pubDate>
      
      <guid>https://garyflynn.com/post/create-active-directory-forest-via-powershell/</guid>
      <description>
        
          
            &lt;p&gt;This blog covers creating a new Active Directory forest and adding a secondary domain controller to the domain via PowerShell.&lt;/p&gt;
&lt;h2 id=&#34;create-active-directory-forest&#34;&gt;Create Active Directory Forest&lt;/h2&gt;
&lt;p&gt;To create a new Active Directory (AD) forest, the below PowerShell commands can be run to simplify the process. To start off, run the below command to install the appropriate Windows Feature.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;ln&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;cl&#34;&gt;Install-WindowsFeature AD-Domain-Services -IncludeManagementTools
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;figure&gt;
  &lt;picture&gt;

    
      
        
        
        
        
        
        
    &lt;img
      loading=&#34;lazy&#34;
      decoding=&#34;async&#34;
      alt=&#34;&#34;
      
        class=&#34;image_figure image_internal image_unprocessed&#34;
        src=&#34;https://garyflynn.com/images/active-directory-forest-1.png&#34;
      
      
    /&gt;

    &lt;/picture&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Run the below command to add the AD module into PowerShell now that it has been installed.&lt;/p&gt;
          
          
        
      </description>
    </item>
    
    <item>
      <title>Useful SCCM Collection Queries</title>
      <link>https://garyflynn.com/post/useful-sccm-collection-queries/</link>
      <pubDate>Wed, 22 Mar 2017 04:39:33 +0000</pubDate>
      
      <guid>https://garyflynn.com/post/useful-sccm-collection-queries/</guid>
      <description>
        
          
            &lt;p&gt;Every Microsoft System Center Configuration Manager (SCCM) administrator has a handful of WQL Collection Queries that you hang onto. I figured I would share my most commonly used queries. Let me know in the comments if you have any others. The below are just examples and you should test if they are appropriate for your environment.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;All Servers&lt;/strong&gt;&lt;br&gt;
select SMS_R_SYSTEM.ResourceID, SMS_R_SYSTEM.ResourceType, SMS_R_SYSTEM.Name, SMS_R_SYSTEM.SMSUniqueIdentifier, SMS_R_SYSTEM.ResourceDomainORWorkgroup, SMS_R_SYSTEM.Client from SMS_R_System inner join SMS_G_System_SYSTEM on SMS_G_System_SYSTEM.ResourceId = SMS_R_System.ResourceId where SMS_G_System_SYSTEM.SystemRole = &amp;quot;Server&amp;quot;&lt;/p&gt;
          
          
        
      </description>
    </item>
    
    <item>
      <title>Increase WinRM / PowerShell Limits</title>
      <link>https://garyflynn.com/post/increase-winrm-powershell-limits/</link>
      <pubDate>Thu, 23 Feb 2017 03:29:06 +0000</pubDate>
      
      <guid>https://garyflynn.com/post/increase-winrm-powershell-limits/</guid>
      <description>
        
          
            &lt;p&gt;For many organisations, PowerShell remoting is done through a scripthost server where maximum concurrent session limits and maximum connected user limits can be reached. As explained in &lt;a href=&#34;https://blogs.msdn.microsoft.com/powershell/2010/05/02/configuring-wsman-limits/&#34;&gt;this Microsoft blog&lt;/a&gt;, the following error might be encountered.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PS&amp;gt; New-PSSession \[localhost\] Connecting to remote server failed with the following error message : The WS-Management service cannot process the request. This user is allowed a maximum number of 5 concurrent shells, which has been exceeded. Close existing shells or raise the quota for this user. For more information, see the about\_Remote\_Troubleshooting Help topic.   \+ CategoryInfo          : OpenError: (System.Manageme….RemoteRunspa   ce:RemoteRunspace) \[\], PSRemotingTransportException   \+ FullyQualifiedErrorId : PSSessionOpenFailed&lt;/code&gt;&lt;/p&gt;
          
          
        
      </description>
    </item>
    
  </channel>
</rss>
